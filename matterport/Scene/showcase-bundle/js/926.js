/*! For license information please see 926.js.LICENSE.txt */
(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[926],{72926:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>E});var r,t=s(97542),i=s(25985),o=s(79727),n=s(53954),c=s(23254),l=s(44443),h=s(7159);class m{constructor(e,a,s,r){this.cameraData=e,this.viewmodeData=a,this.floorsViewData=s,this.sweepData=r,this.name="deeplinks",this.defaultBaseUrl=(0,l.rI)(),this.requiredParams=[...m.requiredUrlParams]}createLink(e){const{baseHref:a,paramFilter:s,thisArg:r}=e||{},t=new URLSearchParams(window.location.search),i=new URL(a||this.defaultBaseUrl.href);for(const[e,a]of t)i.searchParams.set(e,a);return s&&this.filterParamsFromURL(i,s,r),this.removeStartParams(i),this.dedupeModelParam(i),i}createModelLink(e,a){const{baseHref:s,paramFilter:r,thisArg:t}=a||{},i=new URLSearchParams(window.location.search),o=new URL(s||this.defaultBaseUrl.href);for(const[e,a]of i)o.searchParams.set(e,a);return r&&this.filterParamsFromURL(o,r,t),this.removeStartParams(o),o.searchParams.delete("m"),o.searchParams.delete("model"),o.searchParams.set("m",e),o}createDeepLink(e){const{baseHref:a,paramFilter:s,thisArg:r}=e||{},t=new URLSearchParams(h.K.getQueryString({cameraData:this.cameraData,floorsViewData:this.floorsViewData,sweepData:this.sweepData,viewmodeData:this.viewmodeData})),i=new URLSearchParams(window.location.search),o=new URL(a||this.defaultBaseUrl.href);for(const[e,a]of i)o.searchParams.set(e,a);this.removeStartParams(o),s&&this.filterParamsFromURL(o,s,r);for(const[e,a]of t)o.searchParams.set(e,a);return this.dedupeModelParam(o),o}setDefaultBaseHref(e,a){this.defaultBaseUrl=new URL(e),this.requiredParams=[...m.requiredUrlParams,...a]}filterParamsFromURL(e,a,s){for(const[r,t]of e.searchParams)this.requiredParams.includes(r)||a.call(s,r,t)||e.searchParams.delete(r)}dedupeModelParam(e){const a=e.searchParams.get("m")||e.searchParams.get("model")||"";e.searchParams.delete("model"),e.searchParams.set("m",a)}removeStartParams(e){["start","sm","sp","sq","sr","ss","sf","sz"].forEach(e.searchParams.delete,e.searchParams)}}function d(e){return!!e&&"object"==typeof e}m.requiredUrlParams=["m","model"],function(e){e[e.SAME_ORIGIN=0]="SAME_ORIGIN",e[e.EXTERNAL=1]="EXTERNAL",e[e.MODEL=2]="MODEL",e[e.NAVIGATION=3]="NAVIGATION"}(r||(r={}));var N,w=s(12039);!function(e){e[e.IN_FRAME=0]="IN_FRAME",e[e.NEW_WINDOW=1]="NEW_WINDOW",e[e.CUSTOM=2]="CUSTOM"}(N||(N={}));class P{constructor(e){this.commandBinder=e,this.defaultPolicy={[r.NAVIGATION]:N.IN_FRAME,[r.MODEL]:N.IN_FRAME,[r.SAME_ORIGIN]:N.NEW_WINDOW,[r.EXTERNAL]:N.NEW_WINDOW},this.activePolicy=Object.assign({},this.defaultPolicy),this.linkHandlers={[r.NAVIGATION]:{[N.IN_FRAME]:e=>{const a=h.K.deserialize(e);a&&this.navigateToPose(a)},[N.NEW_WINDOW]:e=>this.openNewWindow(e),[N.CUSTOM]:e=>this.customHandlers[r.NAVIGATION](e)},[r.MODEL]:{[N.IN_FRAME]:e=>this.replaceFrameLocation(e),[N.NEW_WINDOW]:e=>this.openNewWindow(e),[N.CUSTOM]:e=>this.customHandlers[r.MODEL](e)},[r.SAME_ORIGIN]:{[N.IN_FRAME]:e=>this.replaceFrameLocation(e),[N.NEW_WINDOW]:e=>this.openNewWindow(e),[N.CUSTOM]:e=>this.customHandlers[r.SAME_ORIGIN](e)},[r.EXTERNAL]:{[N.IN_FRAME]:()=>{throw Error("Navigating Showcase's frame to an external domain is not supported.")},[N.NEW_WINDOW]:e=>this.openNewWindow(e),[N.CUSTOM]:e=>this.customHandlers[r.EXTERNAL](e)}},this.customHandlers={[r.NAVIGATION]:e=>{},[r.MODEL]:e=>{},[r.SAME_ORIGIN]:e=>{},[r.EXTERNAL]:e=>{}}}get HandlingPolicy(){return N}setPolicy(e,a,s){a===N.CUSTOM&&s&&(this.customHandlers[e]=s),this.activePolicy[e]=a}resetPolicy(e){this.activePolicy[e]=this.defaultPolicy[e]}openLink(e){if(function(e){return d(e)&&"pose"in e}(e)){const a=this.activePolicy[r.NAVIGATION];this.linkHandlers[r.NAVIGATION][a](e.fullLink)}else if(function(e){return d(e)&&"modelId"in e}(e)){const a=this.activePolicy[r.MODEL],s=new URL(window.location.href),t=new URL(e.fullLink);s.search=t.search,s.searchParams.delete("m"),s.searchParams.delete("model"),s.searchParams.set("m",e.modelId),s.searchParams.set("play","1"),this.linkHandlers[r.MODEL][a](s.href)}else try{const a=new URL(e);if(a.origin===document.referrer||a.origin===window.location.origin){const a=this.activePolicy[r.SAME_ORIGIN];this.linkHandlers[r.SAME_ORIGIN][a](e)}else{const a=this.activePolicy[r.EXTERNAL];this.linkHandlers[r.EXTERNAL][a](e)}}catch(a){const s=this.activePolicy[r.EXTERNAL];this.linkHandlers[r.EXTERNAL][s](e)}}replaceFrameLocation(e){window.location.replace(e)}openNewWindow(e){window.open(e)}navigateToPose(e){this.commandBinder.issueCommand(new w.L4(e))}}const E=class extends t.Y{constructor(){super(...arguments),this.name="deep linker"}async init(e,a){const[s,r,t,l]=await Promise.all([a.market.waitForData(i.M),a.market.waitForData(c.O),a.market.waitForData(o.c),a.market.waitForData(n.Z)]);this.creator=new m(s,r,t,l),this.handler=new P(a.commandBinder)}get LinkType(){return r}}}}]);